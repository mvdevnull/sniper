Issues/Bugs/Enhancements Section:
---------
sniper.sh
---------
Issue/Bugs

1)nmap rules need to be formated more like eyewitness rules and columns.   (example: need info on nmap)
2)Default creds functionality (now with zebra)
    it needs to support multiple devices (like (sharp,lexmark using curl i made a test for) 
    after we get a cred, we don't want to test it again.  
    we also want to keep it somewhere. maybe in creds-- creds add user:admin password:1234 address:1.1.1.1 port:80 protocol:?dontknow?
    we also may want to do anon ftp for all port 21?
3)RTSP unauth check idea:
    dependency = ffplay
    1)Boa (old axis?) camera  (shame this doesn't confirm that 554 is open :(  )
    services -S Boa -p 8080
    10.42.48.42  8080  tcp    http  open   Boa HTTPd 0.94.14rc21    (But these Boa might be old Axis)   http://10.42.78.17/incl/version.shtml
    10.42.48.55  8080  tcp    http  open   Boa HTTPd 0.94.14rc21
    Then run loop on ip's 
    ffplay rtsp://$ip:554/live.sdp -rtsp_transport tcp&
    
    2)axis cameras
    hosts -S axis -c address
    10.43.46.177             Axis Network Camera                    device         DISCOVERY-Updated-by-sniper.py
    10.43.46.178             Axis Network Camera                    camera         DISCOVERY-Updated-by-sniper.py
    then run loop on ip's 
    ffplay rtsp://$ip:554/axis-media/media.amp -rtsp_transport tcp&
4)Mechanism when rate limiting effects ports scans.
    The following can be used when rate limiting occurs
    send this from random IP's for 2 reasons (1 consecutive IP's avoided,  2 can run multiple processes)
        -p 21,80   (IS 80 covered on initial discovery?)  if so, why did it get skippped last time?
        -p 135,139,143,443,445,993,995,1723,3306,3389 
        -p 5900,8080,53,111,1025,587,8000,8443,32768,49152
        -p 20,19,7,9,13,37,49,69,88,106
        -p 107,113,119,1352,1433,1521,1720,1812,1813,2000
        -p 2049,2100,2222,2375,3128,3268,3269,3388,3527,4000
        -p 4444,5000,5432,5631,5632,5901,5985,5986,6000,6379
        -p 6666,6667,7000,7001,7002,8008,8081,8082,8083,8089 --open 
        -p 8090,8091,8444,8888,9000,9001,9002,9042,9090,9200 --open 
        -p 9300,9418,9443,10000,11211,27017,27018,27019,28017,50000 --open 
        -p 50070,50075,50090,50470,61616,61613,61614,61617,62078,64738 --open 
        -p 6514,6660,6661,6662,6663,6664,6665,7005,7070,7443 --open 
        -p 7777,8009,8010,8069,8086,8087,8098,8181,8448,8500 --open 
        -p 8600,8880,8881,8882,8883,9009,9043,9080,9091,9201 --open 
        -p 9301,9444,9500,9600,9700,9800,9876,9888,9999,10001 --open 
        -p 10002,10010,10100,10200,10443,10500,10990,11000,11200,11300 --open 
        -p 12000,12345,12443,13000,13579,14000,15000,16000,17000,18000 --open 
        -p 19000,20000,21000,22000,23000,24000,25000,26000,27000,28000 --open 
        others...
        -p 554,623
5)db_import *.nessus will reset some hostnames incorrectly.    Would have to "strip" some of the terrible host discovery from XML .nessus to do anything.
    Close try below (but no cigar) to remove OS guess from .nessus file - need to look at this in detail
    awk '/<plugin_output>/ && /Following OS Fingerprints/ {f=0} /<\/plugin_output>/{f=1} f' test.nessus > testnew.nessus
    [-] Failed to import /usr/local/src/github/sniper/nessus/new/testnew.nessus: Could not automatically determine file type

Speed Ideas to consider:
1) nmap -sV is slowest needs to thread or run mult hosts at a time.   (bc we are breaking down by 1 host and 1 port. we need this b/c timeouts give no information when only 1 port fails) (confirmed db_nmap and nmap -sV same speed)  
    (there may be a way to do this with bash to multi-thread, but it's messy) (might be better to wait for bash->python changeover)

Coding Neatness to consider:
1)use functions and classes and get rid of the duplicative coding
2)sometype of debug mode -v -vv
3)convert all sniper.sh  to sniper.py

Enhancements to consider:
1)other msf aux modules to do all time -  example -- use auxiliary/scanner/ftp/anonymous on all FTP (msf>snmp public or >smtpenum or >dns zonexfer)  (there may be some aux modules for misc OS/appliance? might look for ruby code with updates to database and work that way?)
2)right now, eyewitness only get's IP#'s not FQDN.   we could run some magic to replace IP with fqdn if we can resolve.  might need to get a DNS to better resolve though..
3)?for the IIS (older i think), we can run https://github.com/sw33tLie/sns.git  to get folder directory info.  sorta like a DIRB that brutes 1 character at a time..



GAPING HOLES found by msf compatable nessus plugins (BROKEN now)
This code and ideas are in the MAGIC CVE section of sniper.sh and within cve_update in sniper.py


=========================

----------------
sniper.py
--------------
-)add to .py script (at end)  the question to auto assign unknown OS with port 9100 to "Unknown Printer"
-)fix sniper_id.py  (python2 -> python3)

LOGIC BUG:

(-) report findings section
=detect 3.2.1.42 GEN001120 - FAIL rshd.config
=detect 3.2.1.38 GEN001020 - FAIL & root <> console
=plugin 38153, good summary of missing patches(but has to use nessucmd cuz msf db_import doesn't capture)
=how to check last bigfix update done ? 1)NASL like EPO?  2)nessucmd- policy like custom wireshark -> get file -> etc
=maybe id=35730 not ilke %virtual% -- helps find USB devices which could show up as unapproved USB devices?

(-) Confirm credential issues
(need to test all combinations and list definitively)
=good vs not good ssh - if 11936 and method = ssh, then good  (note 21745 is false positive)
=plugin 21745 - cred problem - (works win2k8R2 (UAC enabled) what does it do in linux ssh
=plugin 24786 - you logged in, but without administrator priv's
=???X)possibly something to be smarter about credential issues - there are many different ways for nessus to have cred issues 

-----


#Future Tools (not needed yet, but maybe at some point)
#Third-Party Tools (supplied within the sniper ./third-party-tools directory , but may want to update as needed)
smbshell.nbin 			-----> (nessus tool)
nessrest			-----> pip install nessrest
nessus ----> https://www.tenable.com/downloads/nessus 


---------
Future (Low Priority - if any)
---------
!)sniper is missing in one  example 35% of all IP's by missing pingable and assuming 22,80,443,445 would be open.
a)needs to ping db_nmap -sn first for  the initial range.  be very careful if you do this, if you get all IP's 1-255 results it's false positive.  if you can't account for that situation, might have to forget about it.
b)then subrtract known IP's from above range and generate the remainder.  For the remainder, do the existing db_nmap on port 22,80,443,445 on the rest.

X)Do some logic for Account Credential issues
=1)See parse_nessus_xml.v19.pl  (specifically in section where it lists accounts)
=2)NSS-10860 will get local accounts
=3)NSS-10399 will get domain accounts (may need to change nessus scan policy with ENDUID > 1200)

X)msf cred database functionality
(need to think about the security aspect - storing password for assessment in clear text..? 
run a "cred -a command to add any *VALID* creds recieved from ssh login,etc"  
maybe cred -a [IPaddress] -t password -p 22 -u [user] -P [pass]  

